<!-- Events Section -->
<div class="events mt-5">
    <h3 class="mb-3">Events</h3>
    <% if (events && events.length > 0) { %>
      <div class="row">
        <% _.each(events, function(event) {
          let matchingBookings = [];
          _.each(calendars.timeslots, function(slot) {
            _.each(slot.confirmed_bookings || [], function(booking) {
              if (booking.idpostevent && parseInt(booking.idpostevent) === parseInt(event.id)) {
                matchingBookings.push(booking.identification);
              }
            });
          });
        %>
          <div class="col-md-6 mb-3 events_day" data-id-event="<%= event.id %>">
            <div class="card h-100">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title"><%= event.title %></h5>
                <p class="card-text flex-grow-1"><%= event.event_description || 'No description provided.' %></p>
                <p class="card-text mb-2">
                  <small class="text-muted">Event Time: <%= event.time_event %></small>
                </p>
                <% if (event.event_type) { %>
                  <span class="badge bg-dark mb-2"><%= event.event_type %></span>
                <% } %>
                <% if (matchingBookings.length > 0) { %>
                  <div class="mt-2">
                    <strong>Related Bookings:</strong>
                    <ul class="mb-0 ps-3">
                      <% _.each(matchingBookings, function(name) { %>
                        <li><%= name %></li>
                      <% }); %>
                    </ul>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    <% } else { %>
      <p class="text-muted">No events scheduled for this day.</p>
    <% } %>
</div>